<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<body onload="loadInfo('')">
<div class="container">
    <div class="container-fluid">
		<div class="row">
			<div class="col-md-6" id="body">
				<table class="table table-striped table-hover">
					<thead>
						<tr>
							<th>
								ID
							</th>
							<th>
								Name
							</th>
							<th>
								Designer
							</th>
							<th>
								Year
							</th>
							<th>
							</th>
						</tr>
					</thead>
					<tbody id="tbl-body">
					</tbody>
				</table>
			</div>
			<div class="col-md-6">
				<form role="form" id="searchForm">
					<div class="form-group">
						<input type="text" class="form-control" id="s_id" name="s_id" placeholder="ID">
						<input type="text" class="form-control" id="s_name" name="s_name" placeholder="Name"/>
						<input type="text" class="form-control" id="s_designer" name="s_designer" placeholder="Designer"/>
						<input type="text" class="form-control" id="s_year" name="s_year" placeholder="Year"/>
						<button type="button" class="btn btn-default" onclick="searchPrograms($('#s_id').val(),$('#s_name').val(),$('#s_designer').val(),$('#s_year').val())">
							Search
						</button>
					</div>
				</form>
			</div>
		</div>

		<div class="col-md-6">
			<form role="form" id="updateForm" method="post">
				<div class="form-group">
					<input type="hidden" id="id" name="id">
					<label for="name">
						Name
					</label>
					<input type="text" class="form-control" id="name" name="name"/>
					<label for="designer">
						Designer
					</label>
					<input type="text" class="form-control" id="designer" name="designer"/>
					<label for="year">
						Year
					</label>
					<input type="text" class="form-control" id="year" name="year"/>
					<button type="submit" class="btn btn-default" onclick="saveProgram($('#updateForm'), $('#id').val())">
						Change
					</button>
				</div>
			</form>
		</div>
		<div class="col-md-6">
			<p id="addError" style="color: red; text-align: center"></p>
			<form role="form" id="addForm" action = "" method="post">
				<div class="form-group">
					<label for="name_new">
						Name
					</label>
					<input type="text" class="form-control" id="name_new" name="name_new" />
					<label for="designer_new">
						Designer
					</label>
					<input type="text" class="form-control" id="designer_new" name="designer_new" />
					<label for="year_new">
						Year
					</label>
					<input type="year" class="form-control" id="year_new" name="year_new"/>
					<button type="button" class="btn btn-default" onclick="addProgram($('#addForm'))">
						Add
					</button>
					<a class="btn btn-warning" id="sendRabbitMessageTest">Send RabbitMQ</a>
				</div>
			</form>
		</div>
	</div>
</div>
</body>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="scripts.js"></script>
<script src="stomp.js"></script>
<script type="text/javascript">
	// TEST!
	var ws = new WebSocket('ws://127.0.0.1:15674/ws');
	var client = Stomp.over(ws);

	var on_connect = function(x) {
	  id = client.subscribe("/exchange/errors", function(d) {
	       console.log('New message incoming', d.body);
	  });
	};

	var on_error =  function() {
		console.log('error');
	};

	$('#sendRabbitMessageTest').on('click', function(){
		var message = JSON.stringify($('#addForm').serializeFormJSON());

		console.log('message sent', message);
		client.send('/exchange/errors', {"content-type":"text/plain"}, message);
	});

	client.connect('guest', 'guest', on_connect, on_error, '/');
</script>
</html>